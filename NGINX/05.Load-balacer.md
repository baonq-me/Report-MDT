# Cấu hình Nginx như một bộ cân bằng tải.

Load Balancing hay còn gọi là Cân bằng tải, là một kỹ thuật thường được sử dụng để tối ưu hóa việc sử dụng tài nguyên, băng thông, giảm độ trễ, và tăng cường khả năng chịu lỗi.

Ví dụ khi chúng ta có nhiều hơn một web server, cùng với đó là sự gia tăng lưu lượng truy cập thì việc bổ sung thêm một máy chủ để phân phối lưu lượng này một cách hợp lý là cần thiết. Máy chủ được bổ sung này được gọi là Load balancer

![](https://i.imgur.com/J4aceGC.png)

## Làm Load Balancer cho HTTP.

###  Chuyển tiếp lưu lượng HTTP đến một nhóm các server.

Để cấu hình cân bằng tải thì trước tiên cần phải cấu hình một nhóm các server được định nghĩa với chỉ thị `upstream`, được đặt trong block `http`
Các server trong group được cấu hình bằng chỉ thị `server`. 
Dưới đây là ví dụ về cấu hình 3 server vào group `backend`:

```conf
http {
    upstream backend {
        server backend1.example.com weight=5;
        server backend2.example.com;
        server 192.0.0.1 backup;
    }
}
```

Sau đó, để điều hướng các request đến các server trong nhóm, sử dụng chỉ thị `proxy_pass`(hoặc là `fastcgi_pass`, `memcached_pass`, `scgi_pass`, hoặc `uwsgi_pass` theo từng giao thức.)
Ví dụ sau định nghĩa một virtual host truyền tất cả request đến nhóm upstream `backend` định nghĩa ở ví dụ trước:
```conf
server {
    location / {
        proxy_pass http://backend;
    }
}
```

Dưới đây là kết hợp của hai ví su
















Nguồn tài liệu:
https://kipalog.com/posts/Su-dung-NGINX-nhu-mot-Load-Balancer
https://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/